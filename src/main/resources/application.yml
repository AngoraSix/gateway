server:
  port: ${A6_GATEWAY_PORT:9080}

logging:
  level:
    reactor:
      netty: DEBUG
    org:
      springframework:
        #        web:
        #          reactive: DEBUG
        #        http:
        #          server:
        #            reactive: DEBUG
        cloud:
          gateway: DEBUG

configs:
  api:
    common:
      contributorHeader: ${A6_GATEWAY_COMMON_CONTRIBUTORHEADER:A6-Contributor}
    contributors:
      baseURL: ${A6_GATEWAY_CONTRIBUTORS_URI:http://localhost:9081}
      inBasePath: ${A6_GATEWAY_CONTRIBUTORS_INBASEPATH:contributors}
      outBasePath: ${A6_GATEWAY_CONTRIBUTORS_OUTBASEPATH:auth/admin/realms/Angorasix/users}
    projects:
      coreBaseURL: ${A6_GATEWAY_PROJECTS_CORE_URI:http://localhost:9082}
      coreInBasePath: ${A6_GATEWAY_PROJECTS_CORE_INBASEPATH:projects/core}
      coreOutBasePath: ${A6_GATEWAY_PROJECTS_CORE_OUTBASEPATH:projects-core}
      presentationBaseURL: ${A6_GATEWAY_PROJECTS_PRESENTATION_URI:http://localhost:9083}
      presentationInBasePath: ${A6_GATEWAY_PROJECTS_PRESENTATION_INBASEPATH:projects/presentations}
      presentationInProjectBasedPath: ${A6_GATEWAY_PROJECTS_PRESENTATION_INPROJECTBASEDPATH:projects/(?<projectId>.*?)/presentations}
      presentationOutBasePath: ${A6_GATEWAY_PROJECTS_PRESENTATION_OUTBASEPATH:projects-presentation}
    media:
      baseURL: ${A6_GATEWAY_MEDIA_URI:http://localhost:9084}
      inBasePath: ${A6_GATEWAY_MEDIA_INBASEPATH:media}
      outBasePath: ${A6_GATEWAY_MEDIA_OUTBASEPATH:}
    clubs:
      baseURL: ${A6_GATEWAY_CLUBS_URI:http://localhost:9085}
      inBasePath: ${A6_GATEWAY_CLUBS_INBASEPATH:clubs}
      outBasePath: ${A6_GATEWAY_CLUBS_OUTBASEPATH:clubs}
  internal-routes:
    projectscore:
      isAdminEndpoint: ${A6_GATEWAY_INTERNALROUTES_PROJECTSCORE_ISADMIN::projectId/isAdmin}
  infrastructure:
    exchangeAttributes:
      isProjectAdmin: ${A6_GATEWAY_INFRASTRUCTURE_EXCHANGEATTRIBUTES_ISPROJECTADMIN:org.a6.gateway.infrastructure.exchangeAttributes.isProjectAdmin}

spring:
  config:
    import: file:env.properties,classpath:/routes.yml
  security:
    oauth2:
      resourceserver:
        jwt:
          issuer-uri: ${GATEWAY_SERVICE_OAUTH_SECURITY_ISSUER_URI:http://localhost:9081/auth/realms/Angorasix}
      client:
        registration:
          contributors:
            client-id: ${GATEWAY_SERVICE_OAUTH_CONTRIBUTORS_CLIENT_ID:contributorsClientId}
            client-secret: ${GATEWAY_SERVICE_OAUTH_CONTRIBUTORS_CLIENT_SECRET:contributorsSecret}
            authorization-grant-type: client_credentials
            scope:
        provider:
          contributors:
            token-uri: ${GATEWAY_SERVICE_OAUTH_CONTRIBUTORS_TOKEN_URI:http://localhost:9081/auth/realms/Angorasix/protocol/openid-connect/token}
  application:
    name: ${APP_NAME:gateway}
  cloud:
    gateway:
      globalcors:
        cors-configurations:
          '[/**]':
            allowedOrigins: ${GATEWAY_SERVICE_CORS_ALLOWEDORIGINS:http://localhost:90}
            allowedMethods:
              - GET
      #      httpclient:
      #        wiretap:true
      #      httpserver:
      #        wiretap: true